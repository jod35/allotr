{% extends 'layouts/base.html' %}
{% load static %}
{% load crispy_forms_tags %}
{% block content %}
<div class="container-fluid py-4" id="app">
    <div class="row">
      <div class="col-12">
        <div class="card mb-4 container">
          <div class="card-header pb-0">
            <h6>Programs</h6>
          </div>
          <div class="card-header pb-0">
            <button
              type="button"
              class="btn btn-sm bg-gradient-dark"
              data-bs-toggle="modal"
              data-bs-target="#ProgramCreateModal"
            >
              Create Enrollment
            </button>
          </div>
  
          <div class="card-body px-0 pt-0 pb-2">
            <div class="table-responsive p-0">
              <table id="dtBasicExample" class="display" style="width: 100%">
                <thead>
                  <tr>
                    <th
                      class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7"
                    >
                      Program
                    </th>
                    <th
                      class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7"
                    >
                      Intake
                    </th>
                    <th
                      class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7"
                    >
                      Students Enrolled
                    </th>
                    <th
                      class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7"
                    >
                      Action
                    </th>
                  </tr>
                </thead>
                <tbody>
                  {% for enrollment in enrollments %}
                  <tr>
                    <td>
                        <p class="text-xs font-weight-bold mb-0">{{enrollment.program}}</p>    
                    </td>
                    <td>
                        <p class="text-xs font-weight-bold mb-0"> {{enrollment.intake}}</p>
                    </td>
                    <td>
                      <p class="text-xs font-weight-bold mb-0">
                        {{ enrollment.students_enrolled }}
                      </p>
                    </td>
                    <td class="align-middle">
                      <button
                        type="button"
                        class="btn btn-sm bg-gradient-dark"
                        data-bs-toggle="modal"
                        data-bs-target="#exampleModal"
                        @click="setProgramData(`{{program.id}}`, `{{program.name}}`, `{{program.code}}`, `{{program.years_of_study}}`,`{{program.get_degree_level_display}}`,`{{program.department_id}}`, `{{program.details}}`)"
                      >
                        <i class="fas fa-pen fa-2x"></i>
                      </button>
                    </td>
                  </tr>
                  {% endfor %}
                </tbody>
                <tfoot>
                  <th
                    class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7"
                  >
                    Program
                  </th>
                  <th
                    class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7"
                  >
                    Intake
                  </th>
                  <th
                    class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7"
                  >
                    Students Enrolled
                  </th>
                  <th
                  class="text-uppercase text-secondary text-xxs font-weight-bolder opacity-7"
                >
                  Action
                </th>
                </tfoot>
              </table>
              {% comment %} A Program update and detail form {% endcomment %}
  
              <div
                class="modal modal-lg fade"
                id="exampleModal"
                tabindex="-1"
                role="dialog"
                aria-labelledby="exampleModalLabel"
                aria-hidden="true"
              >
                <div class="modal-dialog modal-dialog-centered" role="document">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="exampleModalLabel">
                        Update Program Info
                      </h5>
                      <button
                        type="button"
                        class="btn-close text-dark"
                        data-bs-dismiss="modal"
                        aria-label="Close"
                      >
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body">
                      <form method="post" action="" id="update-form">
                        {% csrf_token %}
                        <div class="row">
                          <div id="div_id_name" class="col">
                            <label for="id_name" class="requiredField">
                              Name<span class="asteriskField">*</span>
                            </label>
                            <div>
                              <input
                                type="text"
                                name="name"
                                maxlength="255"
                                class="textinput form-control"
                                required
                                id="id_name"
                                :value="[[name]]"
                              />
                            </div>
                          </div>
                          <div id="div_id_code" class="col">
                            <label for="id_code" class="requiredField">
                              Code<span class="asteriskField">*</span>
                            </label>
                            <div>
                              <input
                                type="text"
                                name="code"
                                maxlength="10"
                                class="textinput form-control"
                                required
                                id="id_code"
                                :value="[[code]]"
                              />
                            </div>
                          </div>
                        </div>
                        <div id="div_id_years_of_study" class="form-group">
                          <label for="id_years_of_study" class="requiredField">
                            Years of study<span class="asteriskField">*</span>
                          </label>
                          <div>
                            <input
                              type="number"
                              name="years_of_study"
                              :value="[[years_of_study]]"
                              class="numberinput form-control"
                              required
                              id="id_years_of_study"
                            />
                          </div>
                        </div>
                        <div id="div_id_degree_level" class="form-group">
                          <label for="id_degree_level" class="requiredField">
                            Degree level<span class="asteriskField">*</span>
                          </label>
                          <div>
                            <select
                              name="degree_level"
                              class="select form-control"
                              required
                              id="id_degree_level"
                            >
                              <option value="[[degree_level]]" selected>
                                [[degree_level]]
                              </option>
                              <option value="D">Diploma</option>
                              <option value="B">Bachelors</option>
                              <option value="PGd">PostGraduateDiploma</option>
                              <option value="M">Masters</option>
                            </select>
                          </div>
                        </div>
  
                        <div id="div_id_details" class="form-group">
                          <label for="id_details" class="requiredField">
                            Details<span class="asteriskField">*</span>
                          </label>
                          <div>
                            <textarea
                              name="details"
                              cols="40"
                              rows="5"
                              class="textarea form-control"
                              required
                              id="id_details"
                            >
                            [[details]]</textarea
                            >
                          </div>
                        </div>
                        <div class="modal-footer">
                          <button
                            type="button"
                            class="btn bg-gradient-secondary"
                            data-bs-dismiss="modal"
                            @click="resetState"
                          >
                            Close
                          </button>
                          <button
                            type="button"
                            @click="updateProgram()"
                            class="btn bg-gradient-primary"
                          >
                            Update Program
                          </button>
                          <a
                            href="#"
                            class="btn bg-gradient-danger"
                            data-bs-toggle="modal"
                            data-bs-target="#deleteModal"
                            @click="deleteProgram()"
                            >Delete Program</a
                          >
                        </div>
                      </form>
                    </div>
                  </div>
                </div>
              </div>
  
              {% comment %} Program Create form {% endcomment %}
              <div
                class="modal modal-lg fade"
                id="ProgramCreateModal"
                tabindex="-1"
                role="dialog"
                aria-labelledby="exampleModalLabel"
                aria-hidden="true"
              >
                <div class="modal-dialog modal-dialog-centered" role="document">
                  <div class="modal-content">
                    <div class="modal-header">
                      <h5 class="modal-title" id="exampleModalLabel">
                        Create Enrollment
                      </h5>
                      <button
                        type="button"
                        class="btn-close text-dark"
                        data-bs-dismiss="modal"
                        aria-label="Close"
                        @click="resetState()"
                      >
                        <span aria-hidden="true">&times;</span>
                      </button>
                    </div>
                    <div class="modal-body">
                      <form method="post" action="" id="create-form">
                        <div class="row">
                          <div class="col">{{form.program|as_crispy_field}}</div>
                          <div class="col">{{ form.intake|as_crispy_field }}</div>
                        </div>
                        <div class="form-group">
                          {{ form.students_enrolled |as_crispy_field}}
                        </div>
                        <div class="modal-footer">
                          <button
                            type="button"
                            @click="resetState()"
                            class="btn bg-gradient-dark"
                            data-bs-dismiss="modal"
                          >
                            Close
                          </button>
                          <button
                            type="button"
                            class="btn bg-gradient-primary"
                            @click="createProgram()"
                          >
                            Save
                          </button>
                        </div>
                      </form>
                    </div>
                  </div>
                </div>
              </div>
  
              {% comment %} Modal for deleting Program {% endcomment %}
              <div
                class="modal fade"
                id="deleteModal"
                tabindex="-1"
                role="dialog"
                aria-labelledby="modal-notification"
                aria-hidden="true"
              >
                <div
                  class="modal-dialog modal-danger modal-dialog-centered modal-"
                  role="document"
                >
                  <div class="modal-content">
                    <div class="modal-header">
                      <h6 class="modal-title" id="modal-title-notification">
                        Delete Program
                      </h6>
                      <button
                        type="button"
                        class="btn-close text-dark"
                        data-bs-dismiss="modal"
                        aria-label="Close"
                        @click="resetState()"
                      >
                        <span aria-hidden="true">×</span>
                      </button>
                    </div>
                    <div class="modal-body">
                      <div class="py-3 text-center">
                        <i class="ni ni-bell-55 ni-3x"></i>
                        <h4 class="text-gradient text-danger mt-4">
                          Are you sure you want to delete this Program?
                        </h4>
                        <p>[[name]]</p>
                      </div>
                    </div>
                    <div class="modal-footer">
                      <button
                        type="button"
                        class="btn bg-gradient-danger"
                        @click="deleteProgram()"
                      >
                        Ok, Delete
                      </button>
                      <button
                        type="button"
                        class="btn bg-gradient-dark text-white ml-auto"
                        data-bs-dismiss="modal"
                      >
                        Close
                      </button>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  
    {% include "includes/footer.html" %}
  </div>
{% endblock content %}
    